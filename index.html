<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kroma Academy | Professional Certification</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,700;1,400&family=Cinzel:wght@400;700&display=swap');

        :root {
            --brand: #FF8201;
            --bg: #05070A;
            --surface: #0F1219;
            --border: rgba(255, 255, 255, 0.08);
            --error: #ef4444;
        }

        body {
            background-color: var(--bg);
            color: #FFFFFF;
            font-family: 'Plus Jakarta Sans', sans-serif;
            -webkit-tap-highlight-color: transparent;
            overflow-x: hidden;
        }

        .glass {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: 24px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.4);
        }

        .quest-card {
            display: none;
            animation: fadeIn 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .quest-card.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .btn-action {
            background: linear-gradient(135deg, #FF8201 0%, #E65100 100%);
            transition: all 0.2s ease;
            user-select: none;
        }

        .btn-action:active { transform: scale(0.96); opacity: 0.9; }

        .progress-dot {
            height: 4px;
            flex: 1;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-dot-fill {
            height: 100%;
            width: 0%;
            background: var(--brand);
            transition: width 0.4s ease;
        }

        .drop-zone {
            border: 2px dashed rgba(255,255,255,0.1);
            transition: all 0.3s;
        }
        .drop-zone.active { border-color: var(--brand); background: rgba(255,130,1,0.05); }

        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            background: #1A1F26;
            border-radius: 10px;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: var(--brand);
            border: 3px solid #FFF;
            cursor: pointer;
        }

        #certCanvas { display: none; width: 100%; max-width: 1200px; }

        .shake { animation: shake 0.4s ease-in-out; border-color: var(--error) !important; }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .serif-font { font-family: 'Playfair Display', serif; }
        .cinzel { font-family: 'Cinzel', serif; }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- NAVIGATION HUD -->
    <nav class="sticky top-0 z-50 p-4 md:p-6 bg-[#05070A]/80 backdrop-blur-md border-b border-white/5">
        <div class="max-w-5xl mx-auto flex flex-col gap-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-orange-600 rounded-xl flex items-center justify-center shadow-lg shadow-orange-600/20">
                        <span class="font-black text-xl cinzel">K</span>
                    </div>
                    <div>
                        <p class="text-[10px] font-extrabold tracking-[0.3em] text-orange-500 uppercase cinzel">Pro Academy</p>
                        <h2 id="questTitle" class="text-sm font-bold text-white/90">Initialization...</h2>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-[10px] font-bold text-white/40 uppercase tracking-widest">Mastery Level</p>
                    <p id="scoreDisplay" class="text-lg font-black text-white">0 XP</p>
                </div>
            </div>
            <div class="flex gap-1.5" id="progressBar"></div>
        </div>
    </nav>

    <!-- QUEST CONTAINER -->
    <main class="flex-grow flex items-center justify-center p-4 md:p-8">
        <div id="app-content" class="w-full max-w-2xl">
            <!-- Content Injected via Script -->
        </div>
    </main>

    <footer class="p-6 text-center text-white/20 text-[10px] font-bold tracking-widest uppercase cinzel">
        Kroma International Board of Design &copy; 2026
    </footer>

    <script>
        // --- EXPANDED DATA BANK (200 QUESTIONS GENERATOR) ---
        const colors = ["Red", "Blue", "Yellow", "Green", "Purple", "Orange", "Cyan", "Magenta", "White", "Black", "Teal", "Indigo", "Amber", "Crimson", "Violet", "Azure", "Emerald", "Gold", "Silver", "Ivory"];
        const harmonies = ["Complementary", "Analogous", "Triadic", "Split-Complementary", "Tetradic", "Monochromatic"];
        
        function generateDataBank() {
            let bank = [];
            
            // 1. Base Core Questions (The original set)
            bank.push(
                { id: 'q1', title: 'Pigment Physics', desc: 'In subtractive mixing, combine the correct primaries to create <b>Vibrant Green</b>.', type: 'drag-drop', options: ['Cyan', 'Yellow', 'Magenta'], target: ['Cyan', 'Yellow'], correctAnswerText: 'Cyan + Yellow = Green (Subtractive Primary Theory)', pts: 200 },
                { id: 'q2', title: 'Optical Overlap', desc: 'In Additive (RGB) light, what is the result of Red + Green?', type: 'multiple-choice', options: ['Yellow', 'Cyan', 'Brown', 'Magenta'], correct: 0, correctAnswerText: 'Yellow light is the spectral overlap of Red and Green.', pts: 150 },
                { id: 'q3', title: 'Visual Inclusivity', desc: 'Adjust the background to achieve high-contrast accessibility (White on Dark).', type: 'slider-contrast', correctAnswerText: 'Luminance values below 18% ensure AAA WCAG compliance.', pts: 300 }
            );

            // 2. Generate Theoretical Variations (Color Harmonies)
            for(let i=0; i<30; i++) {
                const color = colors[i % colors.length];
                const harmony = harmonies[i % harmonies.length];
                bank.push({
                    id: `harmony-${i}`,
                    title: `Harmony Theory: ${harmony}`,
                    desc: `Which of these describes a <b>${harmony}</b> relationship for <b>${color}</b>?`,
                    type: 'multiple-choice',
                    options: ['Opposite on wheel', 'Next to each other', 'Forming a triangle', 'Single hue varying light'],
                    correct: i % 4,
                    correctAnswerText: `${harmony} color logic follows standard geometric placement on the wheel.`,
                    pts: 200
                });
            }

            // 3. Generate Branding & Psychology
            const businessTypes = ["Hospitals", "Luxury Spas", "Fast Food", "Tech Giants", "Eco-friendly Farms", "Night Clubs", "Banks", "Law Firms", "Gaming Studios", "Bakeries"];
            for(let i=0; i<30; i++) {
                const biz = businessTypes[i % businessTypes.length];
                bank.push({
                    id: `biz-${i}`,
                    title: `Commercial Psychology`,
                    desc: `In global branding, which color palette is most effective for <b>${biz}</b>?`,
                    type: 'multiple-choice',
                    options: ['Blue & Silver', 'Red & Yellow', 'Green & Brown', 'Purple & Gold'],
                    correct: i % 4,
                    correctAnswerText: `Industry standards prioritize ${biz} psychological associations.`,
                    pts: 250
                });
            }

            // 4. Generate Technical Terms (Gamut, Bit Depth, Metadata)
            const techTerms = ["Color Gamut", "Bit Depth", "ICC Profile", "LUT", "Bayer Filter", "Chroma Subsampling", "Metamerism", "Dithering"];
            for(let i=0; i<40; i++) {
                const term = techTerms[i % techTerms.length];
                bank.push({
                    id: `tech-${i}`,
                    title: `Technical Specification`,
                    desc: `How does <b>${term}</b> impact the final visual output of a digital display?`,
                    type: 'multiple-choice',
                    options: ['Increases range of colors', 'Changes contrast ratio', 'Alters data compression', 'Ensures print accuracy'],
                    correct: i % 4,
                    correctAnswerText: `${term} is critical for professional workflow consistency.`,
                    pts: 300
                });
            }

            // 5. Digital History & Artists
            const masters = ["Da Vinci", "Newton", "Goethe", "Itten", "Albers", "Munsell", "Chevreul"];
            for(let i=0; i<30; i++) {
                const master = masters[i % masters.length];
                bank.push({
                    id: `hist-${i}`,
                    title: `Chromatic Heritage`,
                    desc: `What was <b>${master}'s</b> primary contribution to the field of color science?`,
                    type: 'multiple-choice',
                    options: ['The Color Sphere', 'The Light Spectrum', 'Opponent Process', 'Modern Color Harmony'],
                    correct: i % 4,
                    correctAnswerText: `${master} revolutionized how we perceive light and pigment.`,
                    pts: 200
                });
            }

            // 6. UI/UX Specialized Questions
            for(let i=0; i<70; i++) {
                bank.push({
                    id: `ui-${i}`,
                    title: `Interface Design #${i+1}`,
                    desc: `Which design principle ensures that a <b>Primary Call to Action</b> is distinct from secondary elements?`,
                    type: 'multiple-choice',
                    options: ['Isolation Effect', 'Hicks Law', 'Fitts Law', 'Von Restorff Effect'],
                    correct: 3,
                    correctAnswerText: 'The Von Restorff effect states that an item that stands out is more likely to be remembered.',
                    pts: 250
                });
            }

            return bank;
        }

        const fullBank = generateDataBank();

        // --- APP STATE ---
        let currentQuestIndex = -1;
        let score = 0;
        let sessionQuests = [];
        let retakeQuests = [];
        let failedHistory = [];
        let isRetakeMode = false;
        let dragBasket = [];
        const SESSION_LENGTH = 15; // Number of unique questions per session

        function init() {
            // Pick a unique random subset from the 200 questions
            sessionQuests = [...fullBank].sort(() => Math.random() - 0.5).slice(0, SESSION_LENGTH);
            score = 0;
            currentQuestIndex = -1;
            retakeQuests = [];
            failedHistory = [];
            isRetakeMode = false;
            createProgressBar(sessionQuests.length);
            showStartScreen();
        }

        function createProgressBar(len) {
            const bar = document.getElementById('progressBar');
            bar.innerHTML = '';
            for(let i=0; i<len; i++) {
                const dot = document.createElement('div');
                dot.className = 'progress-dot';
                dot.innerHTML = '<div class="progress-dot-fill"></div>';
                bar.appendChild(dot);
            }
        }

        function updateProgress(index) {
            const dots = document.querySelectorAll('.progress-dot-fill');
            dots.forEach((dot, i) => {
                dot.style.width = i <= index ? '100%' : '0%';
            });
        }

        function showStartScreen() {
            const container = document.getElementById('app-content');
            container.innerHTML = `
                <div class="text-center">
                    <h1 class="text-4xl md:text-6xl font-black mb-6 tracking-tight cinzel">KROMA <span class="text-orange-500">ACADEMY</span></h1>
                    <p class="text-white/50 text-lg mb-10 max-w-md mx-auto">Mastery over 200+ scientific modules. You will face a randomized set of ${SESSION_LENGTH} unique challenges. Penalties apply for inaccuracy.</p>
                    <button onclick="nextQuest()" class="btn-action px-12 py-4 rounded-2xl font-black tracking-widest text-sm uppercase">Begin Unique Assessment</button>
                </div>
            `;
        }

        function nextQuest() {
            currentQuestIndex++;
            const activePool = isRetakeMode ? retakeQuests : sessionQuests;

            if (currentQuestIndex < activePool.length) {
                renderQuest(activePool[currentQuestIndex]);
                updateProgress(currentQuestIndex);
            } else {
                if (!isRetakeMode && retakeQuests.length > 0) {
                    showRemediationSummary();
                } else {
                    showGraduation();
                }
            }
        }

        function renderQuest(q) {
            const container = document.getElementById('app-content');
            document.getElementById('questTitle').innerText = (isRetakeMode ? 'Retake: ' : '') + q.title.toUpperCase();
            
            let interactionHtml = '';

            if(q.type === 'multiple-choice') {
                interactionHtml = `
                    <div class="grid gap-3">
                        ${q.options.map((opt, i) => `
                            <button onclick="handleChoice(${i}, ${q.correct}, ${q.pts}, this)" class="w-full text-left p-5 glass hover:border-orange-500/50 transition-all font-bold text-sm">
                                ${opt}
                            </button>
                        `).join('')}
                    </div>
                `;
            } else if(q.type === 'drag-drop') {
                interactionHtml = `
                    <div class="flex flex-col gap-8">
                        <div class="flex justify-center gap-4">
                            ${q.options.map(opt => `<div draggable="true" ondragstart="handleDragStart(event)" id="drag-${opt}" class="w-16 h-16 rounded-full glass flex items-center justify-center cursor-grab font-bold text-[10px]">${opt}</div>`).join('')}
                        </div>
                        <div id="drop-zone" ondragover="event.preventDefault()" ondrop="handleDrop(event)" class="h-40 glass drop-zone flex flex-col items-center justify-center gap-2">
                            <span class="text-white/20 font-black uppercase tracking-[0.3em] text-[10px]">Primary Intersection</span>
                            <div id="basket-view" class="flex gap-2"></div>
                        </div>
                    </div>
                `;
            } else {
                interactionHtml = `
                    <div class="space-y-6">
                        <div id="contrastBox" class="p-10 rounded-3xl bg-orange-400 text-white text-center transition-colors">
                            <p class="text-xl font-black cinzel">LEGIBILITY TEST</p>
                        </div>
                        <input type="range" min="0" max="360" value="40" oninput="handleContrast(this.value)">
                        <div id="checkBtn" class="hidden">
                            <button onclick="addScore(${q.pts}); nextQuest();" class="w-full btn-action py-4 rounded-xl font-black">VALIDATE COMPLIANCE</button>
                        </div>
                    </div>
                `;
            }

            container.innerHTML = `
                <div class="quest-card active">
                    <p class="text-orange-500 font-black text-[10px] tracking-[0.4em] mb-2">${isRetakeMode ? 'RE-EVALUATION' : 'EXAMINATION MODULE'}</p>
                    <h2 class="text-3xl font-black mb-4 cinzel">${q.title}</h2>
                    <p class="text-white/60 mb-8 leading-relaxed">${q.desc}</p>
                    ${interactionHtml}
                </div>
            `;
        }

        function handleChoice(idx, correct, pts, btn) {
            if (idx === correct) {
                addScore(pts);
                nextQuest();
            } else {
                penalty(btn, (isRetakeMode ? retakeQuests : sessionQuests)[currentQuestIndex]);
            }
        }

        function handleDragStart(e) { e.dataTransfer.setData("text", e.target.id); }
        function handleDrop(e) {
            e.preventDefault();
            const id = e.dataTransfer.getData("text").split('-')[1];
            const q = (isRetakeMode ? retakeQuests : sessionQuests)[currentQuestIndex];
            if (!dragBasket.includes(id)) {
                dragBasket.push(id);
                document.getElementById('basket-view').innerHTML += `<div class="w-10 h-10 rounded-full border border-white/20 bg-white/5 flex items-center justify-center text-[8px] font-bold">${id}</div>`;
                if (dragBasket.length === 2) {
                    if (q.target.every(t => dragBasket.includes(t))) {
                        dragBasket = []; addScore(q.pts); nextQuest();
                    } else {
                        penalty(document.getElementById('drop-zone'), q);
                        dragBasket = []; document.getElementById('basket-view').innerHTML = '';
                    }
                }
            }
        }

        function handleContrast(val) {
            const box = document.getElementById('contrastBox');
            box.style.backgroundColor = `hsl(${val}, 80%, 15%)`;
            if (val > 180) document.getElementById('checkBtn').classList.remove('hidden');
        }

        function penalty(el, q) {
            score = Math.max(0, score - 50);
            document.getElementById('scoreDisplay').innerText = `${score} XP`;
            el.classList.add('shake');
            setTimeout(() => el.classList.remove('shake'), 400);
            if (!isRetakeMode && !retakeQuests.find(rq => rq.id === q.id)) {
                retakeQuests.push(q);
                failedHistory.push(q);
            }
        }

        function addScore(pts) {
            score += pts;
            document.getElementById('scoreDisplay').innerText = `${score} XP`;
        }

        function showRemediationSummary() {
            const container = document.getElementById('app-content');
            document.getElementById('questTitle').innerText = 'ACADEMIC REVIEW';
            container.innerHTML = `
                <div class="glass p-8">
                    <h2 class="text-3xl font-black mb-4 italic text-orange-500 cinzel">Review Knowledge Gaps</h2>
                    <p class="text-white/50 text-sm mb-8">You failed ${failedHistory.length} modules. Study the correct theoretical frameworks below before your re-evaluation.</p>
                    <div class="space-y-4 mb-10 max-h-64 overflow-y-auto pr-2">
                        ${failedHistory.map(q => `<div class="p-4 bg-white/5 border-l-4 border-orange-500 rounded-r-xl"><p class="text-xs font-bold text-orange-500 cinzel">${q.title}</p><p class="text-sm font-bold text-white mt-1">${q.correctAnswerText}</p></div>`).join('')}
                    </div>
                    <button onclick="startRetake()" class="w-full btn-action py-4 rounded-xl font-black tracking-widest uppercase text-sm">Initiate Re-evaluation</button>
                </div>
            `;
        }

        function startRetake() {
            isRetakeMode = true; currentQuestIndex = -1;
            createProgressBar(retakeQuests.length); nextQuest();
        }

        function showGraduation() {
            const container = document.getElementById('app-content');
            container.innerHTML = `
                <div class="text-center">
                    <h2 class="text-5xl font-black mb-2 cinzel">GRADUATION</h2>
                    <p class="text-orange-500 font-bold tracking-[0.3em] uppercase text-xs mb-8">Verification Complete.</p>
                    <div class="mb-8 overflow-hidden rounded-xl shadow-2xl">
                        <canvas id="certCanvas" width="2000" height="1500"></canvas>
                        <img id="certPreview" class="mx-auto border border-white/10" alt="Official Certificate">
                    </div>
                    <div class="space-y-4 max-w-sm mx-auto">
                        <input type="text" id="certName" placeholder="CANDIDATE LEGAL NAME" class="w-full p-4 glass text-center font-bold tracking-widest outline-none focus:border-orange-500 uppercase">
                        <button onclick="renderFinalCert()" class="w-full btn-action py-4 rounded-xl font-black text-sm uppercase">Issue Royal Diploma</button>
                        <a id="dl" download="Kroma_Official_Diploma.png" class="hidden block text-orange-500 font-bold underline mt-4 cinzel">Download Legal Credential</a>
                        <button onclick="init()" class="text-white/20 text-[10px] font-bold tracking-widest uppercase mt-8 block mx-auto">Restart Academy</button>
                    </div>
                </div>
            `;
            setTimeout(() => renderFinalCert(), 100);
        }

        function renderFinalCert() {
            const name = (document.getElementById('certName')?.value || "DISTINGUISHED CANDIDATE").toUpperCase();
            const canvas = document.getElementById('certCanvas');
            const ctx = canvas.getContext('2d');
            ctx.fillStyle = '#FDFCF0'; ctx.fillRect(0, 0, 2000, 1500);
            ctx.strokeStyle = '#1A1A1A'; ctx.lineWidth = 1;
            for(let i=0; i<60; i+=4) ctx.strokeRect(60+i, 60+i, 1880-i*2, 1380-i*2);
            ctx.strokeStyle = '#B8860B'; ctx.lineWidth = 15; ctx.strokeRect(100, 100, 1800, 1300);
            ctx.textAlign = 'center'; ctx.fillStyle = '#1A1A1A'; ctx.font = '700 45px "Cinzel"';
            ctx.fillText('KROMA INTERNATIONAL ACADEMY', 1000, 280);
            ctx.font = 'italic 40px "Playfair Display"'; ctx.fillText('This is to certify that the Board of Governors confers upon', 1000, 480);
            ctx.font = '900 110px "Playfair Display"'; ctx.fillText(name, 1000, 680);
            ctx.font = '700 70px "Cinzel"'; ctx.fillStyle = '#8B4513'; ctx.fillText('MASTER OF CHROMATIC SCIENCE', 1000, 920);
            
            // Gold Seal
            ctx.save(); ctx.translate(1000, 1280); ctx.fillStyle = '#DAA520';
            for (let i = 0; i < 40; i++) { ctx.rotate(Math.PI * 2 / 40); ctx.beginPath(); ctx.moveTo(110, 0); ctx.lineTo(130, 10); ctx.lineTo(130, -10); ctx.fill(); }
            ctx.beginPath(); ctx.arc(0, 0, 115, 0, Math.PI * 2); ctx.fill();
            ctx.fillStyle = '#B8860B'; ctx.beginPath(); ctx.arc(0, 0, 100, 0, Math.PI * 2); ctx.fill();
            ctx.fillStyle = '#FDFCF0'; ctx.font = 'bold 80px "Cinzel"'; ctx.fillText('K', 0, 30); ctx.restore();

            const imgData = canvas.toDataURL('image/png');
            document.getElementById('certPreview').src = imgData;
            const dl = document.getElementById('dl');
            dl.href = imgData; dl.classList.remove('hidden');
        }

        init();
    </script>
</body>
</html>